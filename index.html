
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://ajya.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ajya.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://ajya.github.io/theme/font-awesome/css/font-awesome.min.css">



    <link href="https://ajya.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="The Blog RSS">




    <meta name="author" content="ajya" />
    <meta name="description" content="" />
<meta property="og:site_name" content="The Blog"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="The Blog"/>
<meta property="og:description" content=""/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ajya.github.io"/>

  <title>The Blog</title>

</head>
<body>
  <aside>
    <div>
      <h1><a href="https://ajya.github.io">The Blog</a></h1>


      <nav>
        <ul class="list">

          <li><a href="https://www.outreachy.org/" target="_blank">Outreachy</a></li>
          <li><a href="https://www.openstack.org" target="_blank">OpenStack</a></li>
        </ul>
      </nav>

      <h6 style="margin-bottom:0;">Contact me</h6>
      <ul class="list">
	<li>IRC OFTC: ajya</li>
	<li>Matrix: @ajya:matrix.org</li>
      </ul>

      <ul class="list">
	<a href="https://ajya.github.io/feeds/all.rss.xml">    RSS
</a>
      </ul>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>




<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-summary.html#outreachy-summary">Outreachy: Summary</a></h2>
    <p>
          Posted on Fri 31 August 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>This is the last blog post about my Outreachy internship that will summarize what I have done.</p>
<p>These are the 'main' additions to sushy and sushy tools project:</p>
<ul>
<li>initial version for BIOS resource support in sushy</li>
<li>initial version for @Redfish.Settings used by BIOS and other resources in sushy</li>
<li>emulation of BIOS resource in sushy-tools for libvirt driver and openstacksdk driver</li>
<li>emulation of Ethernet Interface resource in sushy-tools (took over another patch and added openstacksdk driver part)</li>
<li>support for Message registries in sushy (some parts still in code review)</li>
</ul>
<p>However, the implementation is not entirely complete for BIOS and @Redfish.Settings resource support. There are some additional fields that were left out for the first version. In BIOS there is Attribute Registry which currently is not exposed to sushy users but it can help to determine what are the allowed attributes for a particular BIOS and other metadata about the attributes. At the moment there is no input validation happening when setting new BIOS attributes and any failure messages are left until applying the settings and getting back the results in @Redfish.Settings.
In @Redfish.Settings at the moment there is nothing implemented related to @Redfish.SettingsApplyTime. If supported by the Redfish service, this would allow to indicate preferred time to apply the updates.
Also for @Redfish.Settings multi-threading support is not added. In cases if there were 2 or more users trying to update BIOS settings at the same time, for user it will be hard to determine if the update was successful or if failures in the results are caused by their update or one of the peers.
When sushy starts supporting these features, these can also be added to sushy-tools emulation.</p>
<p>In addition to these patches, I did some smaller ones which were followup to these patches or some things that I encountered while working on the 'main' patches. One of the things was that tox was configured to use these python environments: py27, py35, pypy. I believe these were some standard template copy-paste or taken from another project. When running tox, I encountered interpreters not found error for py35 and pypy. Though tox has a flag to skip them, I asked my mentors what's the intention with these. After conversation I removed pypy because it is not expected that anyone will run sushy under pypy and replaced py35 with py3 so that the latest version of py3 is used. On my machine it was py36. Though I installed py35 side by side before removing the exact version from tox. Anyway, with these updates I was testing with py36 locally and I encountered 2 cases where Zuul CI which was still using py35 was failing when my environment was passing. I haven't looked into this more but for some reason there is something with methods in py35 when it is working fine in py27 and py36. So I am not entirely sure that is was ok to remove py35 locally as long as it is necessary to support it. I started to run py35 environment explicitly locally before putting in code review just in case there is this another odd exception with py35 in my code. Recently py36 was also added to Zuul CI so py36 gets tested there too now.</p>
<p>In one of my first blog posts I draw a diagram to comprehend the bare metal server domain which was new to me and I want to look at this diagram again as the internship has ended.
There are not much changes - only 1 new component was introduced for sushy-emulator to start using openstacksdk which was added around the same time my internship started. I did not get to work on Ironic part and overall did not have to interact with other components in the diagram, but it was useful to explore the surroundings back then.</p>
<p><img alt="diagram: Context of sushy, updated" src="https://ajya.github.io/images/project_overview_updated.png"></p>
<p>I think sushy and sushy-tools is a good starting point for new contributors - the project is small and easy to get around, though it did not appear so at the beginning - had to spend some time to get familiar with Redfish and the building blocks of sushy. At the beginning of the internship I had this 'I have no idea what I'm doing' feeling (shadowed by excitement that I'm working on OpenStack), but now I feel comfortable in this domain.</p>
<p>Overall I learned a lot during this 3 months internship and I would like to thank everyone who made this happen, especially my mentors Ilya and Dmitry. Best summer ever.</p>
<p>If anyone else is interested in Outreachy and would like to participate in the next round, they can check their eligibility and start applying very soon - 10th September, see <a href="https://www.outreachy.org/">Outreachy web page</a>.</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-redfish-message-registry-iii-and-license-for-standard-registry-files.html#outreachy-redfish-message-registry-iii-and-license-for-standard-registry-files">Outreachy: Redfish Message registry III and license for standard registry files</a></h2>
    <p>
          Posted on Wed 22 August 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>Outreachy ended last week, here is what I worked on in those last days.</p>
<p>I continued working on Redfish Message Registry. A quick recap, Message registry is necessary to determine severity and provide additional information about the error and possible ways to resolve the error when updating BIOS (and potentially other resources in future). It was clear that it will not be possible to finish it by the end of internship, especially as it all had to go through code reviews. Nevertheless I wanted to have at least initial version of code working from A to Z and to see if there are any more unexpected obstacles to get this to a working stage.</p>
<p>I ended up splitting the Message Registry functionality in 8 patches where each patch tackles something new to sushy library. At first I was avoiding creating too many patches, but I think in the end this makes review easier for everyone as from my experience so far there can be long discussions in reviews - definitely easier that each patch has only 1 (<em>main-ish</em>) thing to discuss rather than creating long threads about, let's say, 3 things and try to follow what's done and what's not.</p>
<p>The patches toward the end of the chain I have set in 'Work in Progress' mode, while they are functionally working, it will be necessary to take a closer look when their dependent patches are reviewed for some edge cases and unhappy paths. I did this it to avoid committing too much while the base of the patches might need re-write or different approach, thus these would require re-write too. But having some code working I can be more sure that there are no unexpected limitations or other things that would require changes in sushy to implement Message Registry support.</p>
<p>At the moment 3 patches have received one +2 each, thus there is some likelihood that they will not require major further changes. While the internship has ended, I like to finish what I have started so I'm keeping an eye on the patches and making updates at my now hobbyist capacity. Anyway, I don't mind that anyone else takes over, however at the moment these patches are missing reviews more.</p>
<p>Given that this is the third post where Message Registry is the main topic, it might be obvious that while I started working on implementing BIOS support in sushy, my biggest addition to sushy turns out to be Message Registry. When started working on this, it was not anticipated or, in other words, the scope and effort was not evaluated, but was discovered along the way. This is how it went - started working on BIOS -&gt; encountered @Redfish.Settings, then -&gt; encountered Message Registry and then -&gt; encountered licensing issue.</p>
<p>Speaking of the licensing issue, it has some updates too. I already had implemented a fall-back scenario where user has to download the standard message registry files and if user has not downloaded them, then there is fall-back for fall-back - giving very limited information about the BIOS updates - only to say if it was successful or not, but no other information which attributes failed or any hints how to resolve the failure. I had this implemented so that there is at least something working while license thing is being resolved. In the legal mailing list it looked that they prefer that no 3rd party files are included in the repository, but DMTF were expecting that by having CC BY license it would be sufficient to include the files in sushy repository. But for this OpenStack technical committee has to have a case-by-case review to allow this. CC BY compability with OpenStack projects is not automatically granted, because OpenStack automatically allows only OSI-approved licenses, but as CC BY is not software license it is not covered by OSI. Anyway, it still sounded like an extra effort and serious matter, but I had no idea how big effort this could be and if sushy really needs the files included. Talked with my mentor if he has experience with technical committee and should we ask tech committee to review this case. As the mentor did not have experience with this, decided to ask this in #openstack-ironic IRC channel and there other contributors were strongly preferring that the files are included in sushy repository and included in installation package as indeed there are many customers who test Ironic without access to the Internet and this would damage user-friendliness if they have to package or download the files manually. Then in the mailing list I asked if this case can be reviewed and it was done very quickly, initial review happened within the same hours in #openstack-tc channel, and final approval happened next day resolving this in less than 24 hours. Very appreciate the fast response and even don't know why I was concerned about the effort involved. The only two things left now are that DMTF release the files under CC BY (which was necessary anyway also in the fall-back scenario so users can download the files and use them) and have to update the patch to use packaged files for standard registries and add license notices.</p>
<p>That's all, but stay tuned for another blog post summarizing my Outreachy internship (no sooner than next week though).</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-redfish-message-registry-ii-and-code-reviews.html#outreachy-redfish-message-registry-ii-and-code-reviews">Outreachy: Redfish Message registry II and code reviews</a></h2>
    <p>
          Posted on Sat 04 August 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <h4>Message Registry</h4>
<p>Since the last blog post, I have started implementing Message Registry. I am splitting this feature in several patches starting with the easy parts - mapping Message Registry File and Message Registry resources to sushy fields. In order to implement this, I encountered a need for a new data structure, dictionary, that was not present in sushy base fields. Implemented it before everything else and currently these 3 patches are in code review.</p>
<p>Having taken a closer look at Message Registry File, I find there are 3 ways how to serve the Registry file itself:</p>
<ul>
<li>locally as a JSON file,</li>
<li>locally in an archive as one of the JSON files,</li>
<li>publicly on the Internet as a JSON file.</li>
</ul>
<p>There is also 4th use case for sushy - to access standard message registry files when a Redfish services have not included them using one of the options above - sushy has to get standard registries elsewhere. This use case was mentioned in the previous blog post when we encountered licensing issue as the standard message files provided by DMTF are only copyrighted without any license. Last time it looked like they will have 3-clause BSD license, but as DMTF did not see them as code, they rejected this idea. Going back to OpenStack legal mailing list, they suggested to use CC license which currently is being reviewed by DMTF.</p>
<p>Thus, the next thing I'm working on - I need to implement registry file loading to support all 4 use cases. It is not difficult task as such, but I need to implement it within sushy design nicely. I have implemented yet another change to sushy base classes, this time to allow processing archives and I'm thinking how should I split these changes in code reviews - should changes to base classes be separate from implementing Message Registry loading or go together so that there is context and actual use case of the changes. I don't want to split too much and I don't want to create patch too big. But I'm not thinking about this too much, or at least I try not to, because it can take forever, so I just pick one and stick with it. If reason why chosen strategy does not work comes up during coding, it can be changed later.</p>
<p>To locally test my changes, I need to have a somewhat working mock Redfish server that has Registry Files supported. None of the mockups provided by DMTF have these Registries included, so I added my own mock files for Registries based on JSON schemas. The next thing - how to serve them. This looks like the use case for <code>sushy-static</code> emulator where it just needs a bunch of JSON files, but in this particular use case I also want to test working with a ZIP archive. However it looks that <code>sushy-static</code> emulator is written in a way it only serves JSON files and understands URL-s that correspond to folder structure and returns <code>index.json</code> files in those folders, definitely not supporting URL or file ending with .zip. Something to think about, if needed for <code>sushy-static</code>, but I'm on a mission to quickly test my code. For sushy so far it was sufficient to test the code in unit tests, but for unit tests I need to know what to mock, this time I really don't know the details of <code>requests</code> returning a file in a response and anyway to be 100% sure need to test that it works with some web server. nginx comes to mind and I set it up to serve static files on my computer. First time I'm doing this on Fedora, usually use Ubuntu, so turns out that SELinux is blocking my choice of port, 2000, and I had some issues with permissions, but did set it up and was able to test my changes and decide how to mock HTTP response.</p>
<h4>Code reviews</h4>
<p>Apart from working on these changes, I'm doing code reviews. In both directions - responding to comments on my patches and leaving some feedback on other patches. Since previous blog post one of the patches - emulating BIOS in <code>sushy-emulator</code> got merged \o/, but code review for Ethernet Interface emulation is still in progress. Usually it just sits and waits for attention from code reviewers as I try to respond as soon as I can to any comments while avoiding context switch when I'm working on new patches. Usually this means that I start or end my days with code reviews. Responding to code reviews can take a lot of time. I think there have been days where that's all I do. Sometimes there are questions in code reviews to which I don't know the best answer and I have to do my own research or try things out. Another thing that re-occurs in code reviews that I get a lot are comments about the code which I have written in the same style or pattern as already existing code. Which means that if I address the comment in my patch, then overall project style will vary and will become messy. I don't see it as a good thing, the project style should be the same even if it is 'wrong' or 'bad' (especially as in some cases this is subjective). Probably 'consistent' is one of the most used words in my code review comments. If it is decided that these changes are necessary, then they are done in a follow-up patch and addressed in all parts of the project to preserve consistency. This also applies when I'm reviewing other patches - trying to not let diverge from the consistency there is in the project. The way I see it - in addition to making the project easier to maintain and code easier to read, the consistency makes contribution for newcomers easier as it serves as a self-referencing sample how should implement any new features. E.g. if there were different approaches for the same problem - how to know which one to pick and why.</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-redfish-message-registry-and-other.html#outreachy-redfish-message-registry-and-other">Outreachy: Redfish Message registry and other</a></h2>
    <p>
          Posted on Fri 20 July 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>This time I will not act surprised that 2 more weeks have passed because I paid attention to time passing by.</p>
<p>In my previous blog post I mentioned that my last patch was failing CI. It turned out that the function <code>assert_called_once</code> is missing in Python 3.5. (it has <code>assert_called_once_with</code> though, but I can't use it this time). Locally I run Python 3.6 where this function is back, and there were no issues in Python 2.7. I replaced this with asserting <code>call_count</code> for now, but this patch still has to pass code reviews.</p>
<p>With that patch put in code review all green, I returned to <code>@Redfish.Settings</code> that had parts left out previously because of too many things that still required clarification. As it stands now, sushy users can update BIOS attributes, but for now sushy does not expose the status of this update.
To get the ball rolling I started to write some code and encountered another dependency - Message Registries. In Redfish response there would be id-s of messages, e.g., <code>Base.1.2.Success</code>, <code>Base.1.2.PropertyValueTypeError</code> and in registry file <code>Base.1.2.0.json</code> that would correspond to section like this<a href="http://redfish.dmtf.org/schemas/registries/Base.1.2.0.json">[1]</a>:</p>
<div class="highlight"><pre><span></span><span class="s2">&quot;PropertyValueTypeError&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;Description&quot;</span><span class="o">:</span> <span class="s2">&quot;Indicates that a property was given the wrong value type, such as when a number is supplied for a property that requires a string.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Message&quot;</span><span class="o">:</span> <span class="s2">&quot;The value %1 for the property %2 is of a different type than the property can accept.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Severity&quot;</span><span class="o">:</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NumberOfArgs&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;ParamTypes&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;string&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Resolution&quot;</span><span class="o">:</span> <span class="s2">&quot;Correct the value for the property in the request body and resubmit the request if the operation failed.&quot;</span>
<span class="p">}</span>
</pre></div>


<p>In order to determine if update is successful need to consult the registry and give user some friendly message. In the given sample above the message supports templates and it has placeholders for parameters. sushy would have to build an error message passing the parameters from <code>@Redfish.Settings</code> for specific case. This approach also supports translating and localizing the messages. But for all this to work I need the registries. None of the provided mockup files have sample of these registries included. According to the schema they can be provided via <code>ServiceRoot.Registry</code> property. I remember somewhere I read that they are optional, but then how should sushy handle the case where Redfish service does not provide them? There could be 2 options: download the files programmatically from <a href="http://redfish.dmtf.org/schemas/registries/">[2]</a> as necessary or include them in sushy package as fallback. Downloading the files wouldn't be a reliable option because sushy might not have access to the external Internet or the site could be just down. Bundling the files together is the direction to go, but then the mentor queried about the license of these files. These standard registry files provided by DMTF have only copyright statement, but no license. That would mean that this is proprietary and cannot be included in OpenStack projects as they require OSI approved license. No-one was sure and I'm not a lawyer either so it was time to contact OpenStack legal mailing list to clarify this<a href="https://wiki.openstack.org/wiki/LegalIssuesFAQ">[3]</a>. Before this I talked with the mentors what could be other options if the files couldn't be included - e.g., manually or using a script parse the files, generate a Python dict and store this derived dictionary instead of the original file.
In the questions to legal mailing list I also included this approach as possible option. Pretty quickly an answer came back which said: NO, the files cannot be included without a license and the same goes for the derived code. As of this writing this is still on-going and DMTF might apply 3-clause BSD license which would be OK for OpenStack project<a href="https://governance.openstack.org/tc/reference/licensing.html">[4]</a>.</p>
<p>On other tasks I did some cleanup patches that emerged from previous code reviews - what usually happens in code reviews is that reviewers notice other thing that need improvement but are not related to the patch in review. Or the necessity for changes is not so big to block the patch but can be done as a followup patch.
One of those patches were to clean up sushy-tools documentation to consistently use the same term. Somehow the docs started to have 'simulator' to describe sushy-emulator and sushy-static. It might have been me because I though of 'simulator' to be more general term. Went through some discussions <a href="https://stackoverflow.com/questions/1584617/simulator-or-emulator-what-is-the-difference">[5]</a><a href="https://english.stackexchange.com/questions/111787/what-is-the-difference-between-simulate-and-emulate">[6]</a> to understand which is the right term to use. Turns out it is 'emulator'. Which also means that the title of my previous blog post is incorrect.</p>
<p>Another thing, I took over a patch that emulated Ethernet Interfaces in sushy-emulator. It was rather an old patch from January this year and since it was created sushy-tools had introduced support for openstackdriver and thus changed some structure in the Flask app too. I rebased and updated with the new structure and added support for openstacksdk driver. Which led me to setting up OpenStack cloud locally. A bit funny, but I haven't had a need to have access to OpenStack cloud before. This time I needed a sample to see how openstacksdk returns data for network interfaces, which was not entirely clear from the docs. I used dev-stack<a href="https://docs.openstack.org/devstack/latest/">[7]</a> on a VM and it worked without any problems. This patch too is in code-review.</p>
<ul>
<li>[1] <a href="http://redfish.dmtf.org/schemas/registries/Base.1.2.0.json">Standard message registry, v.1.2.0</a></li>
<li>[2] <a href="http://redfish.dmtf.org/schemas/registries/">Redfish registries - dmtf.org</a></li>
<li>[3] <a href="https://wiki.openstack.org/wiki/LegalIssuesFAQ">Legal Issues FAQ - openstack.org</a></li>
<li>[4] <a href="https://governance.openstack.org/tc/reference/licensing.html">Licensing requirements - openstack.org</a></li>
<li>[5] <a href="https://stackoverflow.com/questions/1584617/simulator-or-emulator-what-is-the-difference">Simulator or Emulator? What is the difference? - stackoverflow.org</a></li>
<li>[6] <a href="https://english.stackexchange.com/questions/111787/what-is-the-difference-between-simulate-and-emulate">What is the difference between “simulate” and “emulate”? - english.stackexchange.com</a></li>
<li>[7] <a href="https://docs.openstack.org/devstack/latest/">DevStack - openstack.org</a></li>
</ul>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-simulating-bios-for-sushy-tools.html#outreachy-simulating-bios-for-sushy-tools">Outreachy: Simulating BIOS for sushy-tools</a></h2>
    <p>
          Posted on Sun 08 July 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>I can't believe that another 2 weeks have passed since the last blog post.
Shortly after my previous blog post about adding support for BIOS resource in <code>sushy</code> library it got merged \o/. The next thing was to add BIOS support for <code>sushy-tools</code> so that developers can use it during development to test against as bare metals with Redfish are not readily available. Also <code>sushy-tools</code> could be used in CI when running automated tests. There is another developer working on adding BIOS-Redfish support in Ironic.</p>
<p>To re-iterate on <code>sushy-tools</code>, it consists of two simulators <code>sushy-static</code> and <code>sushy-emulator</code>, Sushy static is straightforward - it serves JSON files from provided mockup folder where mockup files can be downloaded from DMTF Redfish page. Whatever is in those JSON files, is returned back to client. <code>sushy-emulator</code> is more dynamic and uses actual systems to emulate what is necessary for Redfish API. Now it supports 2 drivers - libvirt<a href="https://libvirt.org/">[1]</a> and openstacksdk<a href="https://docs.openstack.org/openstacksdk/latest/">[2]</a> (interchangeably also called nova driver).</p>
<p>And to re-iterate on Redfish BIOS resource - it provides BIOS attributes, updating those attributes, resetting the attributes to default and changing BIOS password.</p>
<p>I started to look at implementing BIOS support and writing up a story for storyboard, but stopped when decided to check what there is for libvirt and openstacksdk in relation to BIOS. Because at first I made assumption that there would be some API functions in libvirt and openstack libraries same as there were for parts already implemented. tl;dr; There is none.</p>
<p>Browsing through libvirt and openstack sdk I couldn't see anything that stand out as BIOS API.
Ok, so maybe there is nothing for BIOS, but maybe I don't know what I'm looking for (I don't have much experience with BIOS - as a computer user I have accessed BIOS to change boot order and enable hardware virtualization, if there was anything else I don't remember it). What are these "BIOS attributes"? Looking at the samples provided by DMTF, there are attributes like 'AdminPhone', 'BootMode', 'PowerProfile', 'UsbControl'. I take a look at my BIOS and cannot map these, probably there is something like that, but named slightly different (not expecting to see AdminPhone though).
Still I don't want this let go, and I want to find out how this should work on real servers that support Redfish.</p>
<p>This presentation<a href="https://www.dmtf.org/sites/default/files/Dong_Wei_UEFI_APTS2017.pdf">[3]</a> comes handy and introduces me to UEFI HII (Human Interface Infrastructure) which would be the source for UEFI variables mapped to Redfish BIOS attributes. I read more about it at<a href="https://uefi.blogspot.com/2009/09/uefi-hii-part-1.html">[4]</a> and then go back to libvirt. For openstacksdk it is already clear that there is nothing for BIOS.</p>
<p>A side note, here I'm not looking at legacy BIOS, but UEFI. BIOS is being replaced by UEFI and one day will be gone, however its name still will live in Redfish, Ironic and elsewhere, because at least for Ironic this name is chosen as better cannot be identified<a href="https://specs.openstack.org/openstack/ironic-specs/specs/not-implemented/generic-bios-config.html#proposed-change">[5]</a>.</p>
<p>Back to libvirt, I find that for virtual machines' UEFI, the term OVMF or AAVMF is used<a href="http://blog.wikichoon.com/2016/01/uefi-support-in-virt-install-and-virt.html">[6]</a>. Start searching using OVMF, find a doc about it, go through it<a href="http://www.linux-kvm.org/downloads/lersek/ovmf-whitepaper-c770f8c.txt">[7]</a>, and there it mentions NVRAM config file that contains something and my mentor had mentioned it. I need to take a look what is there. I create a VM with UEFI/OVMF<a href="https://fedoraproject.org/wiki/Using_UEFI_with_QEMU">[8]</a> and get the sample file. Its extension is '.fd' and it's binary file. I try to find if there is some utility to read just to see if something useful is there. Couldn't find it, and even if there is such, it is not part of libvirt API - so <code>sushy-emulator</code> would bypass libvirt API and would have to work with it directly which is not ideal.</p>
<p>OK, here I give up and look at backup plan - have a set of string mimicking BIOS attributes with no effect on VM and stored at libvirt domain XML so that it is persisted between VM and sushy-tools reboots. Where would that be? I cannot find a place for it, but there is section named SMBIOS<a href="https://libvirt.org/formatdomain.html#elementsSysinfo">[9]</a> in libvirt.</p>
<blockquote>
<p>System Management BIOS (SMBIOS) specification defines data structures (and access methods) that can be used to read management information produced by the BIOS of a computer</p>
</blockquote>
<p>Sounds close enough? SBMBIOS has section <code>oemStrings</code> where it can store custom information. But it is added in the latest version released this spring, even I don't have it on my a little bit outdated Fedora (I will upgrade when Outreachy is over :)). And still this is not ideal place for custom data.
Talk with mentors and then we decide that we will start with storing this in emulator's memory that would not be persisted accross reboots. I promise to take another look if really, really there is nothing better in libvirt.
Next time I look and start reading the XML spec from the very beginning (not looking at table of contents which I did before) and here it is - under General data section, there is <code>metadata</code> section that allows to store whatever is necessary using own XML namespace. That is the perfect place for what we need.</p>
<p>There were some other obstacles before I could get to implementing this - due to Flask upgrade tests started to fail in <code>sushy-tools</code> and I tried to fix it (that would be another paragraph about this, but I'm leaving this out so the blog post does not get too long). Once I got back to implementation I did it in less than a day, but there were and still are other patches for sushy-tools which introduce new and restructure existing tests with which I need to align. After the direction to go was clarified I updated my tests.<br>
As of writing this, the patch is submitted and fails CI jobs.<br>
I fixed the first time it failed CI - it was concurrency issue which was not visible locally because I had <code>libvirtd</code> running. I stopped the service and was able to reproduce the test failures. But only when I run full test suite. When I tried to isolate the issue, the tests passed. I found the missing piece and fixed my test setup (had to nullify global driver) and it passed again, but then CI failed again with different errors. Perhaps more concurrency issues, suspecting global variable (everything fine locally).</p>
<p>Overall, it does not feel like already 2 weeks have passed but when I start writing about it a lot of interruptive things come up which I will leave out for brevity. One thing that stands out for me is that I was not noticing some things that I feel I should have. Better attention next time. The good thing - when I was researching UEFI BIOS thing I remembered about and used the Pomodoro technique<a href="https://en.wikipedia.org/wiki/Pomodoro_Technique">[10]</a> with Gnome app<a href="http://gnomepomodoro.org/">[11]</a> to keep myself focused. Worked flawlessly.</p>
<ul>
<li>[1] <a href="https://libvirt.org/">Libivrt - libvirt.org</a></li>
<li>[2] <a href="https://docs.openstack.org/openstacksdk/latest/">openstacksdk - openstack.org</a></li>
<li>[3] <a href="https://www.dmtf.org/sites/default/files/Dong_Wei_UEFI_APTS2017.pdf">Overview of the UEFI Forum - dmtf.org</a></li>
<li>[4] <a href="https://uefi.blogspot.com/2009/09/uefi-hii-part-1.html">UEFI HII (Part 1) - uefi.blogspot.com</a> </li>
<li>[5] <a href="https://specs.openstack.org/openstack/ironic-specs/specs/not-implemented/generic-bios-config.html#proposed-change">Hardware interface for BIOS configuration, Proposed change - openstack.org</a></li>
<li>[6] <a href="http://blog.wikichoon.com/2016/01/uefi-support-in-virt-install-and-virt.html">UEFI support in virt-install and virt-manager - blog.wikichoon.com</a></li>
<li>[7] <a href="http://www.linux-kvm.org/downloads/lersek/ovmf-whitepaper-c770f8c.txt">Open Virtual Machine Firmware (OVMF) Status Report - linux-kvm.org</a></li>
<li>[8] <a href="https://fedoraproject.org/wiki/Using_UEFI_with_QEMU">Using UEFI with QEMU - fedoraproject.org</a></li>
<li>[9] <a href="https://libvirt.org/formatdomain.html#elementsSysinfo">SMBIOS System Information - libvirt.org</a></li>
<li>[10] <a href="https://en.wikipedia.org/wiki/Pomodoro_Technique">Pomodor Technique - wikipedia.org</a></li>
<li>[11] <a href="http://gnomepomodoro.org/">Gnome Pomodoro</a></li>
</ul>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-adding-support-for-redfish-bios-resource-in-sushy.html#outreachy-adding-support-for-redfish-bios-resource-in-sushy">Outreachy: Adding support for Redfish BIOS resource in sushy</a></h2>
    <p>
          Posted on Sun 24 June 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>Time flies and this is my 6th week in Outreachy project. 
My first 'big' task is to implement support for BIOS resource in sushy library.</p>
<p>BIOS resource is one of the Redfish resources beside many others, like Ethernet Interface, Processor which are already implemented in sushy. To shortly describe BIOS resource - it returns a list of BIOS attributes and allows to update them, it also has 2 "actions": Reset the attributes to default value and change BIOS password.</p>
<p>My starting point was an API scheme PDF<a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2046_2017.0a.pdf">[1]</a> referenced in the ticket and merged patch of Ethernet Interface <a href="https://git.openstack.org/cgit/openstack/sushy/commit/?id=8fe2904a62b0f56dc3fc3fefc5a5a746911ce891">[2]</a> which gave me idea which parts of the project I need to touch: implement classes for BIOS resource, add a release note, add a BIOS property to parent resource called System and add unit tests for the new BIOS resource and for new parts of System.</p>
<p>Sounds straightforward, could take a day or two? Of course it did not.</p>
<p>One of the first things I encountered was that for action "Change Password" there are no parameters specified. How to pass new password then? Looked around and discovered that the PDF referenced in the ticket is not the latest version. Found the latest version<a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2046_2018.1_0.pdf">[3]</a> released 14 May 2018, after the ticket was created and this spec has parameters for "Change Password": NewPassword, OldPassword and PasswordName. At least this makes sense now, but what to do with those who are still on previous version? At some point in freenode IRC #openstack-ironic channel I asked this question and people there knew that this was issue with generating JSON schemas from CSDL. Turns out there are CSDL files which are schemas in XML and they appear to be source of truth, not JSON. Good to know, but somehow I'm still sticking to JSON and if in doubt look at CSDL. But I started to look more at JSON schemas themselves, rather then generated PDF. For example, BIOS has it schema at <a href="https://redfish.dmtf.org/schemas/Bios.json">[4]</a>. There is also Schema index <a href="https://redfish.dmtf.org/redfish/schema_index">[5]</a>, but it is easy to guess the URL if know the resource name.
With this resolved I was preparing to submit this patch for code review and while pre-reviewing myself I took another look at sample JSON file for BIOS resource to check if everything is covered. Here is the sample:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;@odata.type&quot;</span><span class="o">:</span> <span class="s2">&quot;#Bios.v1_0_3.Bios&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Id&quot;</span><span class="o">:</span> <span class="s2">&quot;BIOS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Name&quot;</span><span class="o">:</span> <span class="s2">&quot;BIOS Configuration Current Settings&quot;</span><span class="p">,</span>
  <span class="s2">&quot;AttributeRegistry&quot;</span><span class="o">:</span> <span class="s2">&quot;BiosAttributeRegistryP89.v1_0_0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Attributes&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;AdminPhone&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BootMode&quot;</span><span class="o">:</span> <span class="s2">&quot;Uefi&quot;</span><span class="p">,</span>
    <span class="s2">&quot;EmbeddedSata&quot;</span><span class="o">:</span> <span class="s2">&quot;Raid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NicBoot1&quot;</span><span class="o">:</span> <span class="s2">&quot;NetworkBoot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NicBoot2&quot;</span><span class="o">:</span> <span class="s2">&quot;Disabled&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PowerProfile&quot;</span><span class="o">:</span> <span class="s2">&quot;MaxPerf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ProcCoreDisable&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;ProcHyperthreading&quot;</span><span class="o">:</span> <span class="s2">&quot;Enabled&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ProcTurboMode&quot;</span><span class="o">:</span> <span class="s2">&quot;Enabled&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UsbControl&quot;</span><span class="o">:</span> <span class="s2">&quot;UsbEnabled&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;@Redfish.Settings&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;@odata.type&quot;</span><span class="o">:</span> <span class="s2">&quot;#Settings.v1_0_0.Settings&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ETag&quot;</span><span class="o">:</span> <span class="s2">&quot;9234ac83b9700123cc32&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Messages&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;MessageId&quot;</span><span class="o">:</span> <span class="s2">&quot;Base.1.0.SettingsFailed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RelatedProperties&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;#/Attributes/ProcTurboMode&quot;</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;SettingsObject&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;@odata.id&quot;</span><span class="o">:</span> <span class="s2">&quot;/redfish/v1/Systems/437XR1138R2/BIOS/Settings&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Time&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-03-07T14:44.30-05:00&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;Actions&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;#Bios.ResetBios&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;target&quot;</span><span class="o">:</span> <span class="s2">&quot;/redfish/v1/Systems/437XR1138R2/BIOS/Actions/Bios.ResetBios&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;#Bios.ChangePassword&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;target&quot;</span><span class="o">:</span> <span class="s2">&quot;/redfish/v1/Systems/437XR1138R2/BIOS/Actions/Bios.ChangePassword&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;@odata.context&quot;</span><span class="o">:</span> <span class="s2">&quot;/redfish/v1/$metadata#Bios.Bios&quot;</span><span class="p">,</span>
  <span class="s2">&quot;@odata.id&quot;</span><span class="o">:</span> <span class="s2">&quot;/redfish/v1/Systems/437XR1138R2/BIOS&quot;</span>
<span class="p">}</span>
</pre></div>


<p><code>Id</code>, <code>Name</code>, <code>AttributeRegistry</code>, <code>Attributes</code> covered, <code>Actions</code> covered, but what is this <code>@Redfish.Settings</code>? It's not in the schema. I start searching and find this described in Redfish Scalable Platforms Management API Specification<a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP0266_1.5.0.pdf">[6]</a>, this has also HTML version <a href="http://redfish.dmtf.org/schemas/DSP0266_1.5.0.html">[7]</a>, it's handier for me. The field is described in section 7.2.2<a href="http://redfish.dmtf.org/schemas/DSP0266_1.5.0.html#settings">[8]</a>. Turns out this field is used where resource cannot be updated directly, as is the case for BIOS attributes - updates would require system reboot. Ok, looks like a reusable field. I talk with mentors and we decide this should be implemented as a separate patch to keep the patches smaller and make the BIOS patch dependent on this, a chained patch.
Also speaking of this specification<a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP0266_1.5.0.pdf">[6]</a><a href="http://redfish.dmtf.org/schemas/DSP0266_1.5.0.html">[7]</a>, this is better starting point for all Redfish things than Schema PDF, schema PDF is just a human-readable presentation of JSON/CSDL schemas, but then again if reading this first it might be hard to relate to anything in it.
With only few days in I still was not comfortable with sushy project and was confusing myself how I should implement this re-usable field. In hindsight there is nothing to be confused about, but until I got there I peeked at base modules of sushy library to see what's happening there, otherwise I was just copying whatever was done in Ethernet Interface without really knowing and understanding what's happening under the hood.
One thing to mention, which I did not see at the beginning, is that sushy is not a serialization library that serializes JSON to Python classes and back - it does more. sushy users wouldn't have to know Redfish to use sushy with bare metals. It adds some processing where necessary to make its use handy and hides all the web service details. At least that's how I see it now.</p>
<p>With the Settings field done and submitted for code review I returned to the original BIOS patch to make it dependent on Settings patch and update to use Settings field. Then I noticed that there might be a thing that should have been implemented differently in Settings patch. The Settings object holds a URI (see <code>SettingsObject/@odata.id</code> in the sample above) where clients should PATCH and where committed attributes are visible. Committed attributes are those that user updated, but haven't been applied yet as they are waiting for the system reboot. Having this realization that sushy is not just a dumb serialization library, an idea came that sushy should load this resource automatically when user accesses the property in Python. And I made the update to do it. As the Settings field is re-usable field I had to support that it can create a new instance of its parent type. The code introduced some structures and approaches that were not seen anywhere in the project, so I was not sure that this was the way to go, but the only way to find this out is to submit it for code review. So in the next patch update for Settings field I have a re-usable field that could load a settings resource automatically and dynamically based on parent resource type.</p>
<p>With both patches updated and submitted I started to wait for code reviewer feedback. I have been warned that code reviews can take a while, so during that I had some other smaller tickets to work on, and later I started to look at the next bigger ticket.</p>
<p>Looong story short, there were many suggestions how to improve this (still keeping in mind that this is not just serialization library), how to change some things, at one point there was a <code>dict</code> inherited with <code>__setitem__</code> override that instead of updating the <code>dict</code> values, did PATCHing so that sushy user can write <code>attributes['ProcTurboMode'] = 'Disabled'</code> seamlessly without knowing what magic happens behind. This again introduced a lot of structures not seen anywhere else in the project and in the end it was deemed to be too confusing for user instead of being helpful, for example, with code above why does not attribute value in the dictionary change in the end?</p>
<p>Somewhere in between, one question remained unanswered regarding <code>@Redfish.Settings</code> - why isn't this field in the schema of BIOS? What are the other resources that could have this field? <code>grep</code>ing within provided mockup samples, found another case where Ethernet Interface<a href="https://redfish.dmtf.org/redfish/mockups/v1/863#Managers--BMC--NICs--Dedicated">[9]</a> has this field, while other samples of Ethernet Interface did not have this property (e.g., <a href="https://redfish.dmtf.org/redfish/mockups/v1/862#Managers--Blade1BMC--EthernetInterfaces--1">[10]</a>). Also in one of the older versions of mockup sample file Readme<a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2043_1.1.0.zip">[11]</a> there was a short intro in Redfish, and it mentioned that this can also be applied to Storage resources, but I haven't any mockup samples for it so far. This raised another question - what does it mean that <code>@Redfish.Settings</code> field is not present? Does it mean that settings are read-only or that user should patch at the resource itself? The spec was not entirely clear and the Redfish implementations being available on servers which I don't have or have access to, I was not able to check how it works in real life. Talked with mentors, should this be asked in Redfish user forum or are there any other options to find this out, an e-mail thread was started where people with more knowledge on Redfish promptly clarified this - <code>@Redfish.Settings</code> is payload annotation field that can appear in any resource, but practically it will appear where immediate updates are not possible but restart of a system or a service is necessary. When the field is not present, it means that user can patch against the resource itself (not that it is read-only). BIOS will always have this field, because there are no known BIOS that can apply changes without reboot and not expecting to have any in near future. Ethernet Interfaces and Storage might have it or not, and now it is not expected to appear in any other resources.</p>
<p>Another thing that came up this week is, how to determine and inform sushy user of attribute update outcome. In the <code>@Redfish.Settings</code> field there are list of messages returned, time when changes were applied and <code>ETag</code> of the version the changes were applied. How to know when to check for the messages? Could there be some notifications received when updates are done? As there were more questions than answers, it was decided that in this patch this will not be exposed to sushy user to find a good solution in the next patch.</p>
<p>In the end with all the magic removed and even both patches merged back together (it was hard to review as it was changing back and forth), current patch versions are very close to the first versions I proposed. They still are in review, but hopefully will be done soon. I feel like I walked around the world to return at the same point, but during the trip I saw places and had some fun with Python.</p>
<ul>
<li>[1] <a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2046_2017.0a.pdf">Redfish Resource and Schema Guide, v.2017.0a (PDF) - dmtf.org</a></li>
<li>[2] <a href="https://git.openstack.org/cgit/openstack/sushy/commit/?id=8fe2904a62b0f56dc3fc3fefc5a5a746911ce891">Ethernet Interface sushy patch - git.openstack.org</a></li>
<li>[3] <a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2046_2018.1_0.pdf">Redfish Resource and Schema Guide (PDF), v.2018.1 - dmtf.org</a></li>
<li>[4] <a href="https://redfish.dmtf.org/schemas/Bios.json">Redfish BIOS JSON schema - dmtf.org</a></li>
<li>[5] <a href="https://redfish.dmtf.org/redfish/schema_index">Redfish Schema Index - dmtf.org</a></li>
<li>[6] <a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP0266_1.5.0.pdf">Redfish Scalable Platforms Management API Specification (PDF) v.1.5.0 - dmtf.org</a></li>
<li>[7] <a href="http://redfish.dmtf.org/schemas/DSP0266_1.5.0.html">Redfish Scalable Platforms Management API Specification (HTML) v.1.5.0 - dmtf.org</a></li>
<li>[8] <a href="http://redfish.dmtf.org/schemas/DSP0266_1.5.0.html#settings">@Redfish.Settings - dmtf.org</a></li>
<li>[9] <a href="https://redfish.dmtf.org/redfish/mockups/v1/863#Managers--BMC--NICs--Dedicated">Simple Rack-mounted Server mockup, Ethernet Interface - dmtf.org</a></li>
<li>[10] <a href="https://redfish.dmtf.org/redfish/mockups/v1/862#Managers--Blade1BMC--EthernetInterfaces--1">Bladed System mockup, Ethernet Interface - dmtf.org</a></li>
<li>[11] <a href="https://www.dmtf.org/sites/default/files/standards/documents/DSP2043_1.1.0.zip">Scalable Platforms Management API Mockup Readme (ZIP), v.1.1.0 - dmtf.org</a></li>
</ul>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-about-the-project.html#outreachy-about-the-project">Outreachy: About the project</a></h2>
    <p>
          Posted on Tue 05 June 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>When it came to choose a project for which to apply in Outreachy, I was looking for 3 things: mentors are in about the same timezone as me, the project is in tech stack I'm familiar with and want to expand my skills in it, and last but but not least, the project's domain is something interesting and completely new to me.</p>
<p>With the last point I set myself up for a lot of reading (and some videos). </p>
<p>At first I felt like that dog in meme 'I have no idea what I'm doing'. To wrap my head around this, I started to draw a picture with some boxes. Here is the result: </p>
<p><img alt="diagram: Context of sushy" src="https://ajya.github.io/images/project_overview.png"></p>
<p>The project I'm working on is <code>sushy</code> and <code>sushy-tools</code> project. </p>
<p><code>sushy</code> is related to, but not exactly part of, OpenStack Ironic project which deals with bare metal provisioning. Usually when talking about clouds, talk about virtual machines (VM), but there are cases where VMs do not provide necessary performance, so non-virtualized environment is necessary. Here comes Ironic project to manage bare metal servers in cloud environment - remotely. Ironic can be used independently or together with other OpenStack projects with whom it integrates. <code>sushy</code> is written in a way that it does not depend on Ironic and can be used by other projects. And Ironic can decide to use something else instead of <code>sushy</code>. But what does <code>sushy</code> do? Time to introduce Redfish. </p>
<p>Redfish is a standard API to work with bare metal servers. It lives in BMC (Baseboard Management Controller) which is a microcontroller (small computer) attached to motherboard of industrial servers. BMC allows to manage servers remotely and Redfish is one of the protocols to do it. The Redfish standard is managed by DMTF (Distributed Management Task Force).</p>
<p><code>sushy</code> is a client library in Python for Redfish RESTful web services communicating in JSON. <code>ironic</code> imports <code>sushy</code> and uses it as one of the drivers.
<code>sushy</code> is not the only Python library to consume Redfish API, there are alternatives named very similarly:
python-redfish <a href="https://github.com/openstack/python-redfish">[5]</a>
python-redfish-library <a href="https://github.com/DMTF/python-redfish-library">[6]</a></p>
<p>Besides <code>sushy</code> there is also project <code>sushy-tools</code> which contains emulators for testing <code>sushy</code>. Otherwise it is challenging for developers to test Redfish as real server with BMC and Redfish is necessary. There are 2 emulators:
<code>sushy-static</code> which serves static JSON files provided by Redfish project. Mockups can be found at White Papers and Technical Notes section<a href="https://www.dmtf.org/standards/redfish">[4]</a> looking for DSP2043. There is Redfish Mockup Creator<a href="https://github.com/DMTF/Redfish-Mockup-Creator">[7]</a> to generate mockup files from a real Redfish service. But this is little use to me as I don't have access to real Redfish service, but nice to know just in case.</p>
<p>Static mockup file emulator is OK for read only testing, but it does not help much when want to test actions where some changes are necessary. In this case there is <code>sushy-emulator</code> which uses <code>libvirt</code> driver connecting to virtual machine mimicking real server. </p>
<p>DMTF also provides similar emulators, both static mockup files<a href="https://github.com/DMTF/Redfish-Mockup-Server">[8]</a> and dynamic<a href="https://github.com/DMTF/Redfish-Interface-Emulator">[9]</a>. I haven't tried these yet, but might try them out later.
With all the alternatives available, it appears that each project takes different approach, so it is not like they are copies of each other and in the end there is choice.</p>
<p>Lastly, there are some acronyms that I've seen floating around in relation to Ironic that are not directly related to sushy, but I had to find out what they are and how they are related.</p>
<p>PXE (Preboot eXecution Environment) is way to boot up servers from network. Computers supporting PXE has NIC (network interface controller) that is up and listening to commands from network even when server itself is turned off.</p>
<p>IPMI (Intelligent Platform Management Interface) is a way how to manage and monitor servers remotely. </p>
<p>PXE and IPMI have been used together to deploy servers, but they are supposed to be replaced by newer technologies addressing some of their drawbacks - HTTP Boot and Redfish <a href="https://www.youtube.com/watch?v=L-DQKEHX81Q">[10]</a>.</p>
<p><code>libvirt</code>, already mentioned above, is API to manage virtualization, supporting wide range of hypervisors, including VirtualBox, VMWare, Hyper-V.</p>
<p>As always, in hindsight this all speaks for itself, but then again while writing this I discovered new places to go though I can avoid them now - this is just enough for <code>sushy</code>. It will be interesting to revisit this at the end of project and see what has changed in my point of view.</p>
<p>Next time I will write about first tasks I'm working on that should allow me to tell more about <code>sushy</code> and Redfish.</p>
<ul>
<li>[1] <a href="https://wiki.openstack.org/wiki/Ironic">Ironic project wiki - openstack.org</a></li>
<li>[2] <a href="https://wiki.openstack.org/wiki/Ironic">Ironic User Guide - openstack.org</a></li>
<li>[3] <a href="https://docs.openstack.org/sushy/latest/">Sushy documentation - openstack.org</a></li>
<li>[4] <a href="https://www.dmtf.org/standards/redfish">Redfish API docs - dmtf.org</a></li>
<li>[5] <a href="https://github.com/openstack/python-redfish">python-redfish - github.com</a></li>
<li>[6] <a href="https://github.com/DMTF/python-redfish-library">python-redfish-library - github.com</a></li>
<li>[7] <a href="https://github.com/DMTF/Redfish-Mockup-Creator">Redfish Mockup Creator - github.com</a></li>
<li>[8] <a href="https://github.com/DMTF/Redfish-Mockup-Server">Redfish Mockup Server - github.com</a> </li>
<li>[9] <a href="https://github.com/DMTF/Redfish-Interface-Emulator">Redfish Interface Emulator - github.com</a></li>
<li>[10] <a href="https://www.youtube.com/watch?v=L-DQKEHX81Q">Talk from 2015 UEFI Plugfest. Firmware in the Data Center: Goodbye PXE and IPMI. Welcome HTTP Boot and Redfish! - youtube.com</a></li>
<li>[11] <a href="https://redfish.dmtf.org/redfish/v1">In-browser Mockup file explorer -  dmtf.org</a></li>
<li>[12] <a href="https://redfish.dmtf.org/webinars">Intro videos about Redfish API - dmtf.org</a></li>
<li>[13] <a href="https://en.wikipedia.org/wiki/Intelligent_Platform_Management_Interface#Baseboard_management_controller">BMC - wikipedia.org</a></li>
<li>[14] <a href="https://en.wikipedia.org/wiki/Microcontroller">Microcontroller - wikipedia.org</a></li>
<li>[15] <a href="https://en.wikipedia.org/wiki/Preboot_Execution_Environment">Preboot Execution Environment - wikipedia.org</a></li>
<li>[16] <a href="https://en.wikipedia.org/wiki/Libvirt">Libvirt - wikipedia.org</a></li>
</ul>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/outreachy-how-i-got-started-with-openstack-development.html#outreachy-how-i-got-started-with-openstack-development">Outreachy: How I got started with OpenStack development</a></h2>
    <p>
          Posted on Sun 20 May 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>The first week has passed and in this post I will cover what I did to get my first contribution during application phase and some follow up reading afterwards. 
Here I will focus on general tools used in OpenStack development workflow. In next post I will write about the project I'm working on.</p>
<p>It was easy to start developing for OpenStack projects and almost everything I needed to know is well documented in one long page<a href="https://docs.openstack.org/infra/manual/developers.html">[1]</a>. The page contains some links to follow for more detailed information.
One of such pages that I find useful is about commit messages<a href="https://wiki.openstack.org/wiki/GitCommitMessages">[2]</a> that not only writes about messages themselves, but about splitting commits in smaller patches where split is reasonable and somewhat isolated rather than creating one large patch which is harder to review for everyone involved. Also commit messages should be self-contained and hold enough information to understand what's being done and why without accessing other systems like issue/bug tracker. This also says that commit message bodies should be wrapped at 72 characters. The main page<a href="https://docs.openstack.org/infra/manual/developers.html">[1]</a> only mentions commit message headers that should be 50 characters.</p>
<p>Then there are specific OpenStack code style guidelines for Python<a href="https://docs.openstack.org/hacking/latest/user/hacking.html">[3]</a> that also references the general Python style guide, PEP 8<a href="https://www.python.org/dev/peps/pep-0008/">[4]</a>. Here I'm relying on <code>tox</code> to catch any violations.</p>
<p>To write some code, I cloned the necessary projects, branched, and made some changes. There were some tools missing from my development environment that I installed as I went by, and I did not encounter any setup related issues when running projects.</p>
<p>Once the changes are done, the next step is to submit it for code review. </p>
<p>Gerrit is used  for code review, it used to be written in Python, but was rewritten in Java. Wikipedia says<a href="https://en.wikipedia.org/wiki/Gerrit_(software)#History">[5]</a> that it was done to make it easier to run on different Linux systems, but it does not give any reference to source and a quick search online did not help me to find any historical discussions, but this is not so important here, was just curious.
More about Gerrit it is written at <a href="https://review.openstack.org/Documentation/intro-quick.html">[6]</a>. Gerrit distinguishes between core reviewers and regular reviewers, something that I have not seen in other tools where coders enforce it manually. In such cases, it is not like they try to bypass core reviewer requirement (as system does not enforce it), but it makes hard to identify open code reviews that are missing core reviewers, so it is nice that Gerrit has this built-in.</p>
<p>There is a handy tool git-review<a href="https://docs.openstack.org/infra/git-review/">[7]</a> to make work with Gerrit easier - to submit code review just run <code>git review</code> instead of following instructions in Gerrit's quick intro<a href="https://review.openstack.org/Documentation/intro-quick.html">[6]</a>.</p>
<p>Once code review submitted Zuul<a href="https://docs.openstack.org/infra/zuul/">[8]</a> gets involved. Don't have to interact with this much, but Zuul will be the one who will tell if there are tests failing and PEP 8 guidelines violated. This should have been checked locally before submitting code review, but there are always more integrations to run and other issues that might not show up in local environment. As there are many patches submitted within the same time frame, Zuul will queue them and test queued patches together according to their place in queue to catch any conflicts between patches before they get merged to master.
Then when code review is done and usually it requires 2 core code reviewers to approve, the Zuul will merge the changes to master.</p>
<p>That's all for now, if I encounter something new or something I misunderstood in relation to workflow and tools, will share it in further posts.</p>
<ul>
<li>[1] <a href="https://docs.openstack.org/infra/manual/developers.html">OpenStack development manual - https://docs.openstack.org/infra/manual/developers.html</a></li>
<li>[2] <a href="https://wiki.openstack.org/wiki/GitCommitMessages">Git messages guidelines - https://wiki.openstack.org/wiki/GitCommitMessages</a></li>
<li>[3] <a href="https://docs.openstack.org/hacking/latest/user/hacking.html">OpenStack Python style guidelines - https://docs.openstack.org/hacking/latest/user/hacking.html</a></li>
<li>[4] <a href="https://www.python.org/dev/peps/pep-0008/">Python style guidelines - https://www.python.org/dev/peps/pep-0008/</a></li>
<li>[5] <a href="https://en.wikipedia.org/wiki/Gerrit_(software)#History">Gerrit History in Wikipedia - https://en.wikipedia.org/wiki/Gerrit_(software)#History</a></li>
<li>[6] <a href="https://review.openstack.org/Documentation/intro-quick.html">Gerrit quick intro - https://review.openstack.org/Documentation/intro-quick.html</a></li>
<li>[7] <a href="https://docs.openstack.org/infra/git-review/">git-review tool - https://docs.openstack.org/infra/git-review/</a></li>
<li>[8] <a href="https://docs.openstack.org/infra/zuul/">Zuul documentation - https://docs.openstack.org/infra/zuul/</a></li>
</ul>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://ajya.github.io/hello-outreachy.html#hello-outreachy">Hello Outreachy</a></h2>
    <p>
          Posted on Sun 29 April 2018


          &#8226;     Tagged with

              <a href="https://ajya.github.io/tag/outreachy.html">outreachy</a>,              <a href="https://ajya.github.io/tag/openstack.html">openstack</a>
    </p>
  </header>
  <div>
      <p>Hello World, this is my first blog post for my journey as Outreachy intern at OpenStack "Extend Redfish hardware provisioning tooling for Python" project.</p>
  </div>
</article>

  <div class="pagination">
  </div>




    <footer>
<p>&copy; ajya </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " The Blog ",
  "url" : "https://ajya.github.io",
  "image": "",
  "description": ""
}
</script>

</body>
</html>